# ADR 014:Secp256k1署名の可鍛性

## 環境

Secp256k1には2層の延性があります。
署名者には乱数があるため、さまざまな有効な署名を生成できます。
このADRはこれとは何の関係もありません。
可鍛性の第2層は、基本的に署名を与えられた人を許可します
同じ公開鍵から同じメッセージに対してより効果的な署名を生成します。
(彼らはニュースを知る必要さえありません！)
この背後にある数学については、次のセクションで説明します。

多くのダウンストリームアプリケーションでは、署名はトランザクションに表示されるため、txハッシュに表示されることに注意してください。
これは、誰かがsecp256k1署名を使用してトランザクションをブロードキャストした場合、p2pネットワーク内の誰でも署名を別の形式に変更できることを意味します。
したがって、txハッシュ値が変更され、この変更されたtxハッシュ値が送信される場合があります。
これにより、有効なトランザクションをブロードキャストして、そのハッシュがチェーンに含まれるのを待つことができるという仮定が破られます。
例として、宇宙でテキサス州を放送する場合、
そして、シリアル番号を増やす前に、チェーンに表示されるのを待ちます。
別のtxハッシュを送信すると、シリアル番号を増やすことはできません。
シグニチャの第2層のスケーラビリティの問題を排除すると、ダウンストリーム開発を簡素化できます。

### ECDSAコンテキスト

Secp256k1は、特定の曲線上のECDSAです。
署名の形式は `(r、s)`です。ここで、 `s`はフィールド要素です。
(特定のフィールドは `Z_n`で、楕円曲線の次数は` n`です)
ただし、 `(r、-s)`も別の効果的な解決策です。
誰でもグループ要素を否定できるため、2番目の署名を取得できることに注意してください。

## 決定

ECDSA署名の標準形を区別できます。
次に、すべてのECDSA署名に、仕様として定義した形式を採用するように要求します。
非標準形式の署名は拒否します。

標準形は、定義と確認が非常に簡単です。
これは、辞書式順序で定義された `s`の2つの値のうち小さい方のみです。
これは、 `s <n`かどうかをチェックするのではなく、` s <=(n-1)/ 2`をチェックする単純なチェックです。
このパスワードシステムを使用する別の例
これは、https://github.com/zkcrypto/pairing/pull/30#issuecomment-372910663のパリティ定義です。

これは、イーサリアムがsecpのスケーラビリティを解決するために選択したのと同じソリューションです。

## 推奨される実装

フォークhttps://github.com/btcsuite/btcd、[parse sig method](https://github.com/btcsuite/btcd/blob/11fcd83963ab0ecd1b84b429b1efc1d2cdc6d5c5/btcec/signature.go#L19)を更新し、5関数をシリアル化する必要があります私たちの規範的な形を出します。

## ステータス

実装

## 結果

### ポジティブ

-txハッシュがブロックチェーンに表示されることを期待する機能を維持しましょう。

### ネガティブ

-将来のすべての実装でより多くの作業を行います(これは非常に単純なチェックですが)
-別のフォークを維持する必要があります

### ニュートラル
