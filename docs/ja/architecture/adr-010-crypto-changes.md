# ADR 010:暗号通貨の変更

## 環境

Tendermintは、さまざまな暗号化プリミティブを使用および組み合わせた暗号化プロトコルです.

4年近くの開発の後、Tendermintは最近、脆弱性を見つけ、暗号プリミティブの使用と構成を評価するために、複数のセキュリティレビューを受けました.

### ハッシュ関数

Tendermintは通常、特にMerkleツリーの実装において、ハッシュ関数としてRIPEMD160を使用します.

RIPEMD160が選択されたのは、指紋が最も短く、安全であると見なされるのに十分な長さであるためです(つまり、80ビットの誕生日の制限).
SHA256などのNSAによって設計されたアルゴリズムとは異なり、オープンな学術コミュニティでも開発されています.

言い換えれば、暗号化コミュニティはSHA256のセキュリティに同意しているようです.これは一般的な標準になりました.特にSHA1が壊れた今、TLS接続とハードウェアでの最適化されたサポートに必要です.

### メルケルツリー

Tendermintは、単純なMerkleツリーを使用して、トランザクションバッチなどの大きな構造の要約を計算します.
ブロックチェーンのタイトルですら.マークルツリーの長さは、バイト配列を連結してハッシュする前に、バイト配列にプレフィックスを追加します.
RIPEMD160を使用します.

### 住所

ED25519アドレスは、公開鍵のアミノ基でコード化されたRIPEMD160を使用して計算されます.
RIPEMD160は一般に廃止されたハッシュ関数と見なされており、はるかに低速です.
SHA256やBlake2などの最新の機能よりも.

### 認証暗号化

Tendermint P2P接続は、認証された暗号化を使用して、通信におけるプライバシーとIDの検証を提供します.
これは、NaCLEd25519ライブラリを使用した単純なステーション間プロトコルによって実現されます.

実装に抜け穴は見つかりませんでしたが、いくつかの問題があります.

-NaCLはSalsa20を使用します.これは、広く使用されておらず、比較的古くなっているストリーム暗号であり、ChaCha20によって排除されています.
-接続はRIPEMD160を使用して、乱数の暗号化に使用される値を計算します.その使用には微妙な要件があります.

## 決定

### ハッシュ関数

RIPEMD160の代わりに、すべてにSHA256ハッシュ値の最初の20バイトを使用します

###メルケルツリー

する

### 住所

元の32バイトの公開鍵のSHA256の最初の20バイトとしてED25519アドレスを計算します

### 認証暗号化

次の変更を行います.

-xSalsa20の代わりにxChaCha20を使用します-https://github.com/tendermint/tendermint/issues/1124
-乱数の計算には、RIPEMD160の代わりにHKDFを使用します-https://github.com/tendermint/tendermint/issues/1165

## ステータス

実装

## 結果

### ポジティブ

-幅広い採用とハードウェアアクセラレーションを備えた、より近代的で標準的な暗号化機能

### ネガティブ

-正確で認証された暗号化構造は、よく使用されているライブラリではまだ提供されていません

### ニュートラル

## 参照する
