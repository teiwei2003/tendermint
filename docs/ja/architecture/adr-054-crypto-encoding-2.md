# ADR 054:暗号化コーディング(パート2)

## 変更ログ

2020-2-27:作成
2020-4-16:更新

## 環境

アミノは、エコシステムの多くのユーザーにとって常に問題点でした。 Tendermintは、アミノ基の導入によるパフォーマンスの低下による深刻な影響は受けませんが、エンコード形式を広く採用されている形式である[Protocol Buffers](https://developers.google.com/protocol)に移行するために懸命に取り組んでいます。 -バッファ)。この移行により、新しいキーエンコーディング標準が必要になります。これは、エコシステム内の大きな変化につながります。

現在、aminoはキーを `<PrefixBytes> <Length> <ByteArray>`としてエンコードします。

## 決定

以前、Tendermintは、TendermintとCosmos-SDKで使用されるすべてのキータイプを定義していました。将来を見据えて、Cosmos-SDKはキーに対して独自のprotobufタイプを定義します。これにより、Tendermintはコードベース(ed25519)で使用されるキーのみを定義できるようになります。
`oneof`に設定する代わりに、ed25519(` bytes`)の使用法のみを定義する機会がありますが、これは、 `oneof`の作業が後日延期されることを意味します。 `oneof` protobufタイプを使用する場合、可能なキータイプを手動で切り替えてから、それらを必要なインターフェイスに渡す必要があります。

ユーザーの頭痛の種を最小限に抑えるために採用された方法は、すべてのキーエンコーディングがprotobufに転送され、アミノエンコーディングに依存する場合は、カスタムマーシャリングおよびアンマーシャリング機能があります。

Protobufニュース:

```proto
message PubKey {
  oneof key {
    bytes ed25519 = 1;
  }

message PrivKey {
  oneof sum {
    bytes ed25519 = 1;
  }
}
```

>注:下位互換性が必要な場所は明確ではありません。

現在、すべてのモジュールはアミノエンコードされたバイトに依存しておらず、キーは作成に使用されるアミノエンコードではないため、これらの変更を採用するにはハードフォークのアップグレードが必要です。

この作業はいくつかのPRに分割され、この作業は破損前のブランチにマージされ、すべてのPRはマージの前にレビューされます。

1.protobufおよびprotobufメッセージのキーエンコーディング
2. Tendermintタイプをprotobufに移動します。主に、コーディングされているタイプです。
3.リアクターを介して1つずつ、アミノ基によってエンコードされた情報がprotobufに転送されます。
4.テストにはcosmos-sdkおよび/またはtestnetsリポジトリを使用します。

## ステータス

実装

## 結果

-下位互換性が必要なprotobufエンコーディングにキーを移動すると、アミノのグループ化およびグループ化解除機能が使用されます。

### ポジティブ

-プロトコルバッファのエンコーディングは変更されません。
-キーからアミノオーバーヘッドを削除すると、KSMに役立ちます。
-サポートされている言語の巨大なエコシステムを持っています。

### ネガティブ

-ランニングチェーンに統合するには、ハードフォークが必要です。

### ニュートラル

## 参照する

>関連するPRコメント、この問題の原因となった問題、または特定の設計を選択した理由に関する参考記事はありますか？もしそうなら、ここにそれらをリンクしてください！

-{参照リンク}
